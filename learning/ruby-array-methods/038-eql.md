# Array#eql?

- 日付: 2026-02-07
- URL: https://docs.ruby-lang.org/en/4.0/Array.html#method-i-eql-3F
- daily 記録: [daily/2026-02-07.md](../../daily/2026-02-07.md)

## 基本情報

```ruby
eql?(other_array) → true or false
```

自身と `other_array` のサイズが同じで、かつ `self` の各インデックス `i` について `self[i].eql?(other_array[i])` が真である場合に `true` を返します。それ以外の場合は `false` を返します。

## ユーザーの学習記録（daily より）

### 第一印象のメモ

Array だけなんだっけ？String でも使えると思うんだけど

### コード例

```ruby
# eql?(other_array) → true or false
# Returns true if self and other_array are the same size, and if, for each index i in self, self[i].eql?(other_array[i]):
# 自身と`other_array`のサイズが同じで、かつ`self`の各インデックス`i`について`self[i]`と`other_array[i]`が等しい場合に`true`を返します。
a0 = [:foo, 'bar', 2]
a1 = [:foo, 'bar', 2]
a1.eql?(a0) # => true

# Otherwise, returns false.
# それ以外の場合は、false を返します。

# This method is different from method `Array#==`, which compares using method `Object#==`.
# このメソッドは、`Object#==`で比較する`Array#==`とは異なります。
```

## 深掘り・補足

### eql? は Array 専用のメソッドではない

ユーザーの疑問「Array だけなんだっけ？」について：**いいえ、`eql?` は Array 専用ではありません。**

`eql?` は Ruby の `Object` クラスに定義されているメソッドで、すべてのオブジェクトが継承しています。つまり、String、Integer、Hash など、ほぼすべての Ruby オブジェクトで使用できます。

```ruby
# String でも使える
"hello".eql?("hello")  # => true
"hello".eql?("world")  # => false

# Integer でも使える
42.eql?(42)    # => true
42.eql?(42.0)  # => false（型が異なる）

# Hash でも使える
{a: 1}.eql?({a: 1})  # => true
```

### Array#== と Array#eql? の違い

重要なポイントは、`Array#==` と `Array#eql?` の比較方法の違いです：

- **`Array#==`**: 各要素を `Object#==` で比較（型変換を許容する場合がある）
- **`Array#eql?`**: 各要素を `Object#eql?` で比較（より厳密な比較）

```ruby
# 数値の比較で違いが明確に
[1, 2, 3] == [1.0, 2.0, 3.0]     # => true（== は型変換を許容）
[1, 2, 3].eql?([1.0, 2.0, 3.0])  # => false（eql? は厳密に型をチェック）

# 同じ型なら結果は同じ
[1, 2, 3] == [1, 2, 3]     # => true
[1, 2, 3].eql?([1, 2, 3])  # => true
```

### Hash のキーとしての使用

`eql?` は Hash のキー比較にも使われます。これは Hash が内部的に `eql?` と `hash` メソッドを組み合わせてキーの同一性を判定しているためです。

```ruby
hash = {}
hash[1] = "integer one"
hash[1.0] = "float one"

hash[1]    # => "integer one"
hash[1.0]  # => "float one"
# 1 と 1.0 は eql? で false なので、別のキーとして扱われる
```

### 使い分けのポイント

- **`==` を使う**: 一般的な等価比較（値が同じかどうか）
- **`eql?` を使う**: 厳密な等価比較（型も含めて完全に同じかどうか）
- **`equal?` を使う**: オブジェクトの同一性（同じオブジェクト ID かどうか）

### パフォーマンスの考慮事項

`eql?` は `==` と同様に各要素を順番に比較するため、大きな配列では O(n) の時間がかかります。頻繁に比較する場合は、配列のハッシュ値（`hash` メソッド）を先に比較するなどの最適化も検討できます。
